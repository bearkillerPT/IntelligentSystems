{"ast":null,"code":"import fastTag from '../_fastTag.js';\nvar min = 1400;\nvar max = 2100;\nvar dateWords = new Set(['in', 'on', 'by', 'until', 'for', 'to', 'during', 'throughout', 'through', 'within', 'before', 'after', 'of', 'this', 'next', 'last', 'circa', 'around', 'post', 'pre', 'budget', 'classic', 'plan', 'may']);\n\nvar seemsGood = function seemsGood(term) {\n  if (!term) {\n    return false;\n  }\n\n  var str = term.normal || term.implicit;\n\n  if (dateWords.has(str)) {\n    return true;\n  }\n\n  if (term.tags.has('Date') || term.tags.has('Month') || term.tags.has('WeekDay') || term.tags.has('Year')) {\n    return true;\n  } // 1999 Film Festival\n\n\n  if (term.tags.has('ProperNoun')) {\n    return true;\n  }\n\n  return false;\n};\n\nvar seemsOkay = function seemsOkay(term) {\n  if (!term) {\n    return false;\n  }\n\n  if (term.tags.has('Ordinal')) {\n    return true;\n  } // untagged 'june 13 2007'\n\n\n  if (term.tags.has('Cardinal') && term.normal.length < 3) {\n    return true;\n  } // 2020 was ..\n\n\n  if (term.normal === 'is' || term.normal === 'was') {\n    return true;\n  }\n\n  return false;\n};\n\nvar seemsFine = function seemsFine(term) {\n  return term && (term.tags.has('Date') || term.tags.has('Month') || term.tags.has('WeekDay') || term.tags.has('Year'));\n}; // recognize '1993' as a year\n\n\nvar tagYear = function tagYear(terms, i) {\n  var term = terms[i];\n\n  if (term.tags.has('NumericValue') && term.tags.has('Cardinal') && term.normal.length === 4) {\n    var num = Number(term.normal); // number between 1400 and 2100\n\n    if (num && !isNaN(num)) {\n      if (num > min && num < max) {\n        var lastTerm = terms[i - 1];\n        var nextTerm = terms[i + 1];\n\n        if (seemsGood(lastTerm) || seemsGood(nextTerm)) {\n          return fastTag(term, 'Year', '2-tagYear');\n        } // or is it really-close to a year?\n\n\n        if (num >= 1920 && num < 2025) {\n          // look at neighbours\n          if (seemsOkay(lastTerm) || seemsOkay(nextTerm)) {\n            return fastTag(term, 'Year', '2-tagYear-close');\n          } // look at far-neighbours\n\n\n          if (seemsFine(terms[i - 2]) || seemsFine(terms[i + 2])) {\n            return fastTag(term, 'Year', '2-tagYear-far');\n          } // 'the 2002 hit', 'my 1950 convertable'\n\n\n          if (lastTerm && (lastTerm.tags.has('Determiner') || lastTerm.tags.has('Possessive'))) {\n            if (nextTerm && nextTerm.tags.has('Noun') && !nextTerm.tags.has('Plural')) {\n              return fastTag(term, 'Year', '2-tagYear-noun');\n            }\n          }\n        }\n      }\n    }\n  }\n\n  return null;\n};\n\nexport default tagYear;","map":null,"metadata":{},"sourceType":"module"}