{"ast":null,"code":"var shouldSkip = function shouldSkip(last) {\n  // is it our only choice?\n  if (last.length <= 1) {\n    return false;\n  }\n\n  var obj = last.parse()[0] || {};\n  return obj.isSubordinate;\n}; // try to chop-out any obvious conditional phrases\n// he wore, [if it was raining], a raincoat.\n\n\nvar noSubClause = function noSubClause(before) {\n  var parts = before.clauses();\n  parts = parts.filter(function (m, i) {\n    // if it was raining..\n    if (m.has('^(if|unless|while|but|for|per|at|by|that|which|who|from)')) {\n      return false;\n    } // bowed to her,\n\n\n    if (i > 0 && m.has('^#Verb . #Noun+$')) {\n      return false;\n    } // the fog, suddenly increasing in..\n\n\n    if (i > 0 && m.has('^#Adverb')) {\n      return false;\n    }\n\n    return true;\n  }); // don't drop the whole thing.\n\n  if (parts.length === 0) {\n    return before;\n  }\n\n  return parts;\n}; //\n\n\nvar lastNoun = function lastNoun(vb) {\n  var before = vb.before(); // try to drop any mid-sentence clauses\n\n  before = noSubClause(before); // parse-out our preceding nouns\n\n  var nouns = before.nouns(); // look for any dead-ringers\n\n  var last = nouns.last(); // i/she/he/they are very strong\n\n  var pronoun = last.match('(i|he|she|we|you|they)');\n\n  if (pronoun.found) {\n    return pronoun.nouns();\n  } // these are also good hints\n\n\n  var det = nouns.if('^(that|this|those)');\n\n  if (det.found) {\n    return det;\n  }\n\n  if (nouns.found === false) {\n    det = before.match('^(that|this|those)');\n\n    if (det.found) {\n      return det;\n    }\n  } // should we skip a subbordinate clause or two?\n\n\n  last = nouns.last();\n\n  if (shouldSkip(last)) {\n    nouns.remove(last);\n    last = nouns.last();\n  } // i suppose we can skip two?\n\n\n  if (shouldSkip(last)) {\n    nouns.remove(last);\n    last = nouns.last();\n  }\n\n  return last;\n};\n\nvar isPlural = function isPlural(subj, vb) {\n  // 'we are' vs 'he is'\n  if (vb.has('(are|were|does)')) {\n    return true;\n  }\n\n  if (subj.has('(those|they|we)')) {\n    return true;\n  }\n\n  if (subj.found && subj.isPlural) {\n    return subj.isPlural().found;\n  }\n\n  return false;\n};\n\nvar getSubject = function getSubject(vb) {\n  var subj = lastNoun(vb);\n  return {\n    subject: subj,\n    plural: isPlural(subj, vb)\n  };\n};\n\nexport default getSubject;","map":null,"metadata":{},"sourceType":"module"}